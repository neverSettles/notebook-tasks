..F.                                                                     [100%]
=================================== FAILURES ===================================
______________________________ test_top_genes_csv ______________________________

    def test_top_genes_csv():
        """Verify top genes analysis output."""
        import csv
        path = "/home/user/top_genes.csv"
        assert os.path.exists(path), f"Top genes CSV missing at {path}"
        with open(path) as f:
            reader = csv.DictReader(f)
            rows = list(reader)
>       assert len(rows) == 5, f"Expected 5 top genes, got {len(rows)}"
E       AssertionError: Expected 5 top genes, got 4
E       assert 4 == 5
E        +  where 4 = len([{'fold_change': '1.0', 'gene_id': 'gene_A', 'max_expression': '20', 'min_expression': '10'}, {'fold_change': '0.58496...': '55'}, {'fold_change': '0.32192809488736235', 'gene_id': 'gene_C', 'max_expression': '100', 'min_expression': '80'}])

test.py:73: AssertionError
=========================== short test summary info ============================
FAILED test.py::test_top_genes_csv - AssertionError: Expected 5 top genes, got 4
1 failed, 3 passed in 0.02s
