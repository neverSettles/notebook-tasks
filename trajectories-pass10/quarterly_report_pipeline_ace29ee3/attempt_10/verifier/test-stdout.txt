..F                                                                      [100%]
=================================== FAILURES ===================================
__________________________ test_final_report_content ___________________________

    def test_final_report_content():
        report_path = '/home/user/final_report.csv'
    
        with open(report_path, 'r', encoding='utf-8') as f:
            reader = csv.DictReader(f)
            rows = list(reader)
    
        assert len(rows) == 5, f"Expected 5 rows in the final report, found {len(rows)}."
    
        # Sort rows by 'id' to ensure predictable checking
        rows.sort(key=lambda x: int(x['id']))
    
        # Verify columns
        expected_columns = {'id', 'date', 'feedback', 'agent_id', 'revenue'}
        actual_columns = set(rows[0].keys())
        assert expected_columns.issubset(actual_columns), f"Expected columns {expected_columns}, but found {actual_columns}."
    
        # Row 1 text cleaning
>       assert "Great service by agent! Contact me at [EMAIL]." == rows[0]['feedback'], "Row 1 text cleaning failed (HTML tags, email, or whitespace)."
E       AssertionError: Row 1 text cleaning failed (HTML tags, email, or whitespace).
E       assert 'Great servic...e at [EMAIL].' == 'Hello [EMAIL]'
E         
E         - Hello [EMAIL]
E         + Great service by agent! Contact me at [EMAIL].

test.py:32: AssertionError
=========================== short test summary info ============================
FAILED test.py::test_final_report_content - AssertionError: Row 1 text cleani...
1 failed, 2 passed in 0.02s
