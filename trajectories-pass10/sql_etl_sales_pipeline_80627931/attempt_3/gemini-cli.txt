YOLO mode is enabled. All tool calls will be automatically approved.
YOLO mode is enabled. All tool calls will be automatically approved.
I will create the Jupyter Notebook with the specified ETL pipeline steps.

The Jupyter Notebook has been created at `/home/user/etl_pipeline.ipynb` and is ready for automated testing. 

It contains a single cell that executes your ETL pipeline requirements cleanly from top to bottom:
1. Imports `pandas` and `sqlite3`.
2. Loads `/home/user/raw_sales.csv` into a DataFrame.
3. Creates an in-memory SQLite database and registers the DataFrame to the `sales` table.
4. Executes the aggregation query grouping by `region`, calculating the `SUM(amount) AS total_revenue`, and applying the `RANK() OVER (ORDER BY SUM(amount) DESC) AS sales_rank` window function.
5. Exports the structured DataFrame directly to `/home/user/clean_sales.csv` with `index=False` to meet your formatting constraint.
