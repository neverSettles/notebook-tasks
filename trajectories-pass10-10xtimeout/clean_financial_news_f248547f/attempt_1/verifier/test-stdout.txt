...F                                                                     [100%]
=================================== FAILURES ===================================
___________________________ test_output_csv_contents ___________________________

    def test_output_csv_contents():
        """Verify the columns and data inside the cleaned output CSV."""
        output_csv = "/home/user/cleaned_news.csv"
        if not os.path.exists(output_csv):
            pytest.skip("Output CSV does not exist; skipping content checks.")
    
        with open(output_csv, "r", encoding="utf-8") as f:
            reader = csv.reader(f)
            try:
                headers = next(reader)
            except StopIteration:
                pytest.fail(f"Output CSV {output_csv} is empty.")
    
            expected_columns = ["date", "cleaned_headline", "price"]
            assert headers == expected_columns, f"Incorrect columns in output. Expected {expected_columns}, got {headers}"
    
            actual_headlines = []
            for row in reader:
                if len(row) >= 2:
                    actual_headlines.append(row[1])
    
            expected_headlines = [
                "company xyz announces new product",
                "terrible day markets",
                "economic boom horizon",
                "investors looking safe havens"
            ]
    
>           assert actual_headlines == expected_headlines, (
                f"Headlines not cleaned correctly.\nExpected: {expected_headlines}\nGot: {actual_headlines}"
            )
E           AssertionError: Headlines not cleaned correctly.
E             Expected: ['company xyz announces new product', 'terrible day markets', 'economic boom horizon', 'investors looking safe havens']
E             Got: ['quick brown fox jumping over lazy dog money 1000']
E           assert ['quick brown...g money 1000'] == ['company xyz... safe havens']
E             
E             At index 0 diff: 'quick brown fox jumping over lazy dog money 1000' != 'company xyz announces new product'
E             Right contains 3 more items, first extra item: 'terrible day markets'
E             Use -v to get more diff

test.py:56: AssertionError
=========================== short test summary info ============================
FAILED test.py::test_output_csv_contents - AssertionError: Headlines not clea...
1 failed, 3 passed in 0.02s
