.FF                                                                      [100%]
=================================== FAILURES ===================================
_________________ test_clean_inventory_csv_exists_and_correct __________________

    def test_clean_inventory_csv_exists_and_correct():
        """Verify the cleaned CSV is correctly formatted."""
        assert os.path.isfile(OUTPUT_CSV_PATH), f"Cleaned CSV missing at {OUTPUT_CSV_PATH}"
    
        with open(OUTPUT_CSV_PATH, "r", encoding="utf-8") as f:
            content = f.read().strip()
    
        # Replace CRLF with LF to ensure consistent comparison
        content = content.replace("\r\n", "\n")
    
>       assert content == EXPECTED_CSV_CONTENT.strip(), f"Content of {OUTPUT_CSV_PATH} does not match expected output."
E       AssertionError: Content of /home/user/clean_inventory.csv does not match expected output.
E       assert 'item_id,prod...-12-31, test3' == 'item_id,prod...E,,2023-03-05'
E         
E         + item_id,product_price,date_added,other_col
E         + 1,10.5,2023-01-01, test
E         + 2,,, test2
E         + 3,,2023-12-31, test3
E         - item_id,product_name,product_price,date_added
E         - 101,Widget A,12.5,2022-12-31...
E         
E         ...Full output truncated (4 lines hidden), use '-vv' to show

test.py:53: AssertionError
__________________ test_schema_report_json_exists_and_correct __________________

    def test_schema_report_json_exists_and_correct():
        """Verify the schema report JSON is correctly formatted."""
        assert os.path.isfile(OUTPUT_JSON_PATH), f"Schema JSON missing at {OUTPUT_JSON_PATH}"
    
        with open(OUTPUT_JSON_PATH, "r", encoding="utf-8") as f:
            try:
                schema = json.load(f)
            except json.JSONDecodeError:
                pytest.fail(f"File {OUTPUT_JSON_PATH} does not contain valid JSON.")
    
>       assert schema == EXPECTED_SCHEMA, f"Content of {OUTPUT_JSON_PATH} does not match expected schema dict. Got {schema}"
E       AssertionError: Content of /home/user/schema_report.json does not match expected schema dict. Got {'item_id': 'int64', 'product_price': 'float64', 'date_added': 'object', 'other_col': 'object'}
E       assert {'date_added'...e': 'float64'} == {'date_added'...e': 'float64'}
E         
E         Omitting 3 identical items, use -vv to show
E         Left contains 1 more item:
E         {'other_col': 'object'}
E         Right contains 1 more item:
E         {'product_name': 'object'}
E         Use -v to get more diff

test.py:65: AssertionError
=========================== short test summary info ============================
FAILED test.py::test_clean_inventory_csv_exists_and_correct - AssertionError:...
FAILED test.py::test_schema_report_json_exists_and_correct - AssertionError: ...
2 failed, 1 passed in 3.14s
