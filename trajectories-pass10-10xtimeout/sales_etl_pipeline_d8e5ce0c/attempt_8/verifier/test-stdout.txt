.FFF                                                                     [100%]
=================================== FAILURES ===================================
____________________________ test_checkpoint_1_long ____________________________

    def test_checkpoint_1_long():
        filepath = "/home/user/checkpoint_1_long.csv"
        assert os.path.exists(filepath), f"{filepath} is missing."
    
        data = read_csv_as_dicts(filepath)
        assert len(data) == 12, f"Expected 12 rows in {filepath}, found {len(data)}."
    
        expected_rows = {
            ("S1", "North", "2023-01-01", "100.0"),
            ("S2", "South", "2023-01-01", "300.0"),
            ("S3", "East", "2023-01-01", "150.0"),
            ("S1", "North", "2023-01-02", "150.0"),
            ("S2", "South", "2023-01-02", "100.0"),
            ("S3", "East", "2023-01-02", "0.0"),
            ("S1", "North", "2023-02-01", "200.0"),
            ("S2", "South", "2023-02-01", "400.0"),
            ("S3", "East", "2023-02-01", "250.0"),
            ("S1", "North", "2023-02-02", "250.0"),
            ("S2", "South", "2023-02-02", "150.0"),
            ("S3", "East", "2023-02-02", "300.0"),
        }
    
        actual_rows = set()
        for row in data:
            sales = float(row.get("Sales", 0.0))
            actual_rows.add((row.get("Store_ID"), row.get("Region"), row.get("Date"), f"{sales:.1f}"))
    
>       assert actual_rows == expected_rows, f"Data in {filepath} does not match expected output."
E       AssertionError: Data in /home/user/checkpoint_1_long.csv does not match expected output.
E       assert {('S1', 'Nort...'300.0'), ...} == {('S1', 'Nort...'100.0'), ...}
E         
E         Extra items in the left set:
E         ('S3', 'East', '2023-01-01', '50.0')
E         ('S2', 'South', '2023-02-15', '400.0')
E         ('S2', 'South', '2023-01-01', '0.0')
E         ('S2', 'South', '2023-02-01', '0.0')
E         ('S3', 'East', '2023-02-01', '70.0')...
E         
E         ...Full output truncated (15 lines hidden), use '-vv' to show

test.py:50: AssertionError
____________________________ test_checkpoint_2_agg _____________________________

    def test_checkpoint_2_agg():
        filepath = "/home/user/checkpoint_2_agg.csv"
        assert os.path.exists(filepath), f"{filepath} is missing."
    
        data = read_csv_as_dicts(filepath)
        assert len(data) == 6, f"Expected 6 rows in {filepath}, found {len(data)}."
    
        expected_rows = {
            ("S1", "2023-01", "250.0"),
            ("S1", "2023-02", "450.0"),
            ("S2", "2023-01", "400.0"),
            ("S2", "2023-02", "550.0"),
            ("S3", "2023-01", "150.0"),
            ("S3", "2023-02", "550.0"),
        }
    
        actual_rows = set()
        for row in data:
            sales = float(row.get("Total_Sales", 0.0))
            actual_rows.add((row.get("Store_ID"), row.get("Month"), f"{sales:.1f}"))
    
>       assert actual_rows == expected_rows, f"Data in {filepath} does not match expected output."
E       AssertionError: Data in /home/user/checkpoint_2_agg.csv does not match expected output.
E       assert {('S1', '2023...02', '150.0')} == {('S1', '2023...02', '550.0')}
E         
E         Extra items in the left set:
E         ('S2', '2023-01', '300.0')
E         ('S3', '2023-02', '150.0')
E         ('S3', '2023-01', '110.0')
E         ('S2', '2023-02', '400.0')
E         Extra items in the right set:...
E         
E         ...Full output truncated (5 lines hidden), use '-vv' to show

test.py:73: AssertionError
______________________________ test_final_report _______________________________

    def test_final_report():
        filepath = "/home/user/final_report.csv"
        assert os.path.exists(filepath), f"{filepath} is missing."
    
        data = read_csv_as_dicts(filepath)
        assert len(data) == 3, f"Expected 3 rows in {filepath}, found {len(data)}."
    
        expected_rows = {
            ("S1", "250.0", "450.0"),
            ("S2", "400.0", "550.0"),
            ("S3", "150.0", "550.0"),
        }
    
        actual_rows = set()
        for row in data:
            val1 = float(row.get("2023-01", 0.0))
            val2 = float(row.get("2023-02", 0.0))
            actual_rows.add((row.get("Store_ID"), f"{val1:.1f}", f"{val2:.1f}"))
    
>       assert actual_rows == expected_rows, f"Data in {filepath} does not match expected output."
E       AssertionError: Data in /home/user/final_report.csv does not match expected output.
E       assert {('S1', '250.....0', '150.0')} == {('S1', '250.....0', '550.0')}
E         
E         Extra items in the left set:
E         ('S2', '300.0', '400.0')
E         ('S3', '110.0', '150.0')
E         Extra items in the right set:
E         ('S3', '150.0', '550.0')
E         ('S2', '400.0', '550.0')
E         Use -v to get more diff

test.py:94: AssertionError
=========================== short test summary info ============================
FAILED test.py::test_checkpoint_1_long - AssertionError: Data in /home/user/c...
FAILED test.py::test_checkpoint_2_agg - AssertionError: Data in /home/user/ch...
FAILED test.py::test_final_report - AssertionError: Data in /home/user/final_...
3 failed, 1 passed in 0.03s
